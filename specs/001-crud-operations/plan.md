# Implementation Plan: CRUD Operations for Posts

**Branch**: `001-crud-operations` | **Date**: 2026-02-27 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-crud-operations/spec.md`

**Note**: This plan is generated by the `/speckit.plan` command following the Phase 0-1 workflow.

## Summary

Implement full Create, Read, Update, Delete (CRUD) operations for social media posts in the existing React application. Users will be able to create new posts with title and body content, edit existing posts, delete posts with confirmation, and view detailed post information. The implementation extends the existing PostsContext state management and api.service layer, adds form components with validation, and includes dialog components for edit/create/delete operations. All operations integrate with JSONPlaceholder API endpoints and maintain the current engagement metrics and hashtag extraction functionality.

## Technical Context

**Language/Version**: TypeScript 5.9.3 with React 19.2.0  
**Primary Dependencies**: React 19.2, Vite 7.3, shadcn/ui components (@radix-ui), Tailwind CSS 4.2, date-fns 4.1, lucide-react 0.575  
**Storage**: Remote API (JSONPlaceholder) with client-side state management via React Context  
**Testing**: Jest 30.2 with React Testing Library 16.3, @testing-library/user-event 14.6, minimum 80% coverage  
**Target Platform**: Modern web browsers (Chrome, Firefox, Safari, Edge) with mobile responsive design  
**Project Type**: Single-page web application (SPA) with component-based architecture  
**Performance Goals**: < 2.5s LCP, < 100ms FID, < 0.1 CLS, < 3s API response time, 60fps UI interactions  
**Constraints**: < 200KB initial bundle (gzipped), WCAG 2.1 Level AA accessibility, mobile-first responsive design  
**Scale/Scope**: Small-to-medium scale demo application, ~10-20 components, focused on post management workflows

## Constitution Check

_GATE: Must pass before Phase 0 research. Re-check after Phase 1 design._

### ✅ Test-Driven Development (TDD)

- **Status**: PASS
- **Compliance**: All new components, hooks, and service functions will have tests written first following Red-Green-Refactor cycle
- **Coverage Target**: Minimum 80% coverage for all new code
- **Test Types**: Unit tests for components/functions, integration tests for CRUD workflows, user interaction tests

### ✅ Code Quality Standards

- **Status**: PASS
- **SonarQube**: Will maintain zero critical issues, <5% technical debt ratio, <3% duplication
- **ESLint**: Existing strict TypeScript configuration will apply to all new code
- **Prettier**: Auto-formatting enabled with existing configuration
- **Code Review**: Standard 2-approval process applies

### ✅ UX Consistency

- **Status**: PASS
- **Component Library**: Will use existing shadcn/ui components (Dialog, Form, Button, Input, Textarea)
- **Design System**: Follows existing typography, color tokens, spacing (8px grid), Lucide icons
- **Accessibility**: WCAG 2.1 AA compliant - keyboard navigation, ARIA labels, focus indicators, 4.5:1 contrast
- **Responsive**: Mobile-first design using existing Tailwind breakpoints (640px, 1024px)
- **User Feedback**: Loading states, error messages, success confirmations, form validation feedback

### ✅ Performance Requirements

- **Status**: PASS
- **Core Web Vitals**: Existing optimization strategies maintained (code splitting, lazy loading, memoization)
- **Bundle Impact**: Estimated +15-20KB for new components (form, dialog, validation logic)
- **React Performance**: Will use React.memo for PostForm, useCallback for handlers, optimistic UI updates
- **API Optimization**: Optimistic updates, error retry logic with exponential backoff, request debouncing for rapid actions

### ⚠️ Development Workflow

- **Status**: CONDITIONAL PASS
- **Note**: Standard GitFlow branching already applied (feature branch `001-crud-operations` created)
- **Commits**: Will follow Conventional Commits specification
- **Action**: No violations, standard workflow applies

## Project Structure

### Documentation (this feature)

```text
specs/001-crud-operations/
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output - technology decisions & patterns
├── data-model.md        # Phase 1 output - entities & validation rules
├── quickstart.md        # Phase 1 output - developer getting started guide
├── contracts/           # Phase 1 output - API contracts & UI component interfaces
│   ├── api-contracts.md      # POST/PUT/DELETE endpoint contracts
│   └── component-contracts.md # Form & Dialog component interfaces
└── checklists/
    └── requirements.md  # Specification validation checklist (existing)
```

### Source Code (repository root)

```text
src/
├── components/
│   ├── Post/                    # Existing - will be enhanced
│   │   ├── Post.tsx
│   │   ├── Post.test.tsx
│   │   └── index.ts
│   ├── PostActions/             # Existing - will be enhanced with Edit/Delete
│   │   ├── PostActions.tsx
│   │   ├── PostActions.test.tsx
│   │   └── index.ts
│   ├── PostForm/                # NEW - Create/Edit form component
│   │   ├── PostForm.tsx
│   │   ├── PostForm.test.tsx
│   │   └── index.ts
│   ├── PostDialog/              # NEW - Modal for create/edit operations
│   │   ├── PostDialog.tsx
│   │   ├── PostDialog.test.tsx
│   │   └── index.ts
│   ├── DeleteConfirmDialog/     # NEW - Confirmation dialog for deletion
│   │   ├── DeleteConfirmDialog.tsx
│   │   ├── DeleteConfirmDialog.test.tsx
│   │   └── index.ts
│   ├── PostDetailModal/         # NEW - Detailed post view
│   │   ├── PostDetailModal.tsx
│   │   ├── PostDetailModal.test.tsx
│   │   └── index.ts
│   └── ui/                      # Existing shadcn/ui components
│       ├── dialog.tsx           # NEW - Dialog primitive from shadcn/ui
│       ├── input.tsx            # NEW - Input primitive from shadcn/ui
│       ├── textarea.tsx         # NEW - Textarea primitive from shadcn/ui
│       ├── label.tsx            # NEW - Label primitive from shadcn/ui
│       └── [existing UI components]
├── contexts/
│   ├── PostsContext.tsx         # ENHANCED - Add CRUD operations
│   └── PostsContext.test.tsx    # ENHANCED - Add tests for CRUD
├── services/
│   ├── api.service.ts           # ENHANCED - Add createPost, updatePost, deletePost
│   └── api.service.test.ts      # ENHANCED - Add tests for new endpoints
├── lib/
│   ├── utils.ts                 # Existing utilities
│   └── validation.ts            # NEW - Form validation utilities
├── hooks/
│   ├── usePostForm.ts           # NEW - Form state management hook
│   └── usePostForm.test.ts      # NEW - Hook tests
└── types/
    ├── post.types.ts            # ENHANCED - Add CreatePostDTO, UpdatePostDTO
    └── api.types.ts             # Existing API types

tests/
├── integration/
│   └── post-crud.test.tsx       # NEW - End-to-end CRUD workflow tests
└── [existing test directories]
```

**Structure Decision**: Single-project web application structure maintained. All new components follow existing component organization pattern with co-located tests and index exports. Enhanced components preserve backward compatibility. New UI primitives from shadcn/ui added to existing ui/ directory. Form validation logic separated into dedicated lib/validation.ts module for reusability.

## Complexity Tracking

> **No violations to justify** - All constitution checks passed without requiring complexity additions.

---

## Phase Completion Status

### ✅ Phase 0: Outline & Research (COMPLETE)

**Output**: [research.md](./research.md)

**Completed Activities**:

- ✅ Resolved all Technical Context unknowns
- ✅ Evaluated form management approaches → Custom hooks with controlled components
- ✅ Selected dialog/modal strategy → shadcn/ui Dialog component
- ✅ Defined API integration pattern → Extend existing api.service.ts
- ✅ Designed state management strategy → Enhanced PostsContext with optimistic updates
- ✅ Specified form validation approach → Custom validation utilities in lib/validation.ts
- ✅ Defined component architecture → Composition-based with single-responsibility
- ✅ Planned testing strategy → Jest + RTL with 80% coverage target
- ✅ Documented accessibility requirements → WCAG 2.1 Level AA compliance
- ✅ Identified performance optimizations → Memoization, lazy loading, code splitting
- ✅ Listed dependencies to add → shadcn/ui components (no new npm packages)
- ✅ Assessed risks and mitigations → JSONPlaceholder limitations documented

**Key Decisions**:

- Use controlled components with usePostForm custom hook (no React Hook Form)
- Leverage shadcn/ui Dialog for all modal interactions
- Implement optimistic UI updates for better perceived performance
- Client-side validation with custom utilities (no Yup/Zod)
- PATCH method for updates (lighter than PUT)

---

### ✅ Phase 1: Design & Contracts (COMPLETE)

**Outputs**:

- [data-model.md](./data-model.md)
- [contracts/api-contracts.md](./contracts/api-contracts.md)
- [contracts/component-contracts.md](./contracts/component-contracts.md)
- [quickstart.md](./quickstart.md)

**Completed Activities**:

- ✅ Defined core entities (Post, CreatePostRequest, UpdatePostRequest, DeletePostRequest, PostFormData)
- ✅ Specified validation rules for all input fields
- ✅ Documented entity relationships and state transitions
- ✅ Created API contracts for all CRUD endpoints (POST, PATCH, DELETE)
- ✅ Defined error handling and retry logic patterns
- ✅ Documented component interfaces with props, state, and behavior
- ✅ Specified component hierarchy and composition
- ✅ Designed custom hooks (usePostForm) interface
- ✅ Enhanced PostsContext interface with CRUD operations
- ✅ Created developer quickstart guide with TDD workflow
- ✅ Updated agent context file (GitHub Copilot instructions)

**Key Artifacts**:

- **Data Model**: 7 entities defined with full validation rules and state transitions
- **API Contracts**: 4 endpoints documented with request/response formats and error handling
- **Component Contracts**: 10 components specified with complete prop interfaces
- **Quickstart Guide**: Complete development workflow with TDD examples and implementation order

---

### ⏸️ Phase 2: Task Breakdown (NOT STARTED)

**Note**: Phase 2 (task breakdown) is executed via the `/speckit.tasks` command, not by `/speckit.plan`.

**Next Step**: Run `/speckit.tasks` to break down the implementation plan into actionable development tasks with time estimates and dependencies.

---

## Constitution Re-check (Post-Design)

All constitution gates remain **PASSED** after Phase 1 design:

- ✅ **TDD**: Component contracts and testing strategy fully defined
- ✅ **Code Quality**: ESLint/Prettier/SonarQube standards maintained
- ✅ **UX Consistency**: shadcn/ui components used exclusively, a11y requirements specified
- ✅ **Performance**: Optimization strategies defined (memo, lazy loading, optimistic updates)
- ✅ **Workflow**: Standard GitFlow applied, agent context updated

**No new violations introduced during design phase.**

---

## Summary

### Plan Status: ✅ COMPLETE (Phases 0-1)

**Branch**: `001-crud-operations`  
**Specification**: [spec.md](./spec.md) (validated, all checks passed)

### Artifacts Generated

| Phase | Artifact                                                               | Status      | Description                       |
| ----- | ---------------------------------------------------------------------- | ----------- | --------------------------------- |
| 0     | [research.md](./research.md)                                           | ✅ Complete | Technology decisions and patterns |
| 1     | [data-model.md](./data-model.md)                                       | ✅ Complete | Entity definitions and validation |
| 1     | [contracts/api-contracts.md](./contracts/api-contracts.md)             | ✅ Complete | API endpoint specifications       |
| 1     | [contracts/component-contracts.md](./contracts/component-contracts.md) | ✅ Complete | Component interfaces              |
| 1     | [quickstart.md](./quickstart.md)                                       | ✅ Complete | Developer onboarding guide        |
| 1     | `.github/agents/copilot-instructions.md`                               | ✅ Updated  | Agent context with tech stack     |

### Implementation Readiness

**Ready to Proceed**: ✅ YES

The plan is complete and ready for task breakdown and implementation. All design decisions are documented, contracts are defined, and development guidelines are established.

### Next Steps

1. **Run** `/speckit.tasks` to generate task breakdown (creates `tasks.md`)
2. **Review** quickstart guide for development workflow
3. **Begin implementation** following TDD principles (tests first!)
4. **Follow** the implementation order defined in quickstart.md:
   - Phase 1: Foundation (validation, types, API service)
   - Phase 2: Context & State (PostsContext, usePostForm hook)
   - Phase 3: UI Components (forms, dialogs, modals)
   - Phase 4: Integration (connect components to App)
   - Phase 5: Polish & Accessibility (a11y audit, performance)

### Technology Stack Summary

- **Frontend**: React 19.2, TypeScript 5.9
- **Build Tool**: Vite 7.3
- **Styling**: Tailwind CSS 4.2
- **UI Components**: shadcn/ui (@radix-ui)
- **Testing**: Jest 30.2, React Testing Library 16.3
- **API**: JSONPlaceholder (fake REST API)
- **State**: React Context
- **Icons**: Lucide React 0.575

### Estimated Scope

- **New Components**: 6 (PostForm, PostDialog, DeleteConfirmDialog, PostDetailModal, + 4 UI primitives)
- **Enhanced Components**: 3 (Post, PostActions, PostsContext)
- **New Utilities**: 2 (validation.ts, usePostForm hook)
- **New Types**: 4 DTOs (CreatePostRequest, UpdatePostRequest, DeletePostRequest, PostFormData)
- **Test Files**: 10+ (unit tests + integration tests)
- **Estimated Effort**: 8-10 development days (following TDD, including tests and a11y)
